
node {


@groovy.transform.Canonical 
class URLConfig {
  String repo
  String url
  String pomPath
}

 echo "loop ends-----------------------11"
    stage ('Clone') {
        git url: 'https://github.com/sadheeshkt/autobuild.git'
    }
    echo "loop ends-----------------------22"
    def urlConfigList
    echo "loop ends-----------------------33"
    def urlList = new File(pwd()+'/autobuild.config') as String[]
    echo "loop ends-----------------------44"
    urlList.each {
        println it
        echo "loop ends-----------------------55"
        def (value1, value2,value3) = it.tokenize( '##' )
        echo "loop ends-----------------------66"
        urlConfigList.add(new URLConfig(value1,value2, value3))
    }
    echo "loop ends-----------------------77"
    echo "loop ends-----------------------88"
    urlConfigList.each {
        println it
        echo "repo> "+it.repo+" url> "+it.url+" pomPath> "+it.pomPath
    }
    
    
    
    
    
    
    def mvnHome
    stage ('Clone') {
        git url: 'https://github.com/sadheeshkt/spring-cld.git'
    }
    stage('Build') {
         def workspace = pwd()
         def workspacePath= workspace.replace("Program Files (x86)", "PROGRA~2");
         echo 'workspacePath>'+workspacePath
         def pomFile=workspacePath+"/greeting-service/pom.xml"
         
         git url : "https://github.com/sadheeshkt/spring-cld.git"
         mvnHome = tool 'maven3'
         def pom = readMavenPom file: 'greeting-service/pom.xml'
         echo pom.version
         bat "${mvnHome}/bin/mvn -f $pomFile clean compile package"
     }
}
