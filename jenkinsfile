

node {
    stage ('Clone') {
        git url: 'https://github.com/sadheeshkt/autobuild.git'
    }
 def classesGroovy = load 'Classes.groovy'
 def urlConfig = classesGroovy.URLConfig
def urlConfigList = []

 echo  "urlConfigList1.size"+urlConfigList.size()


 

    echo "loop ends-----------------------22"

    echo "loop ends-----------------------33"
    def urlList = new File(pwd()+'/autobuild.config') as String[]
    echo "loop ends-----------------------44"
    for ( item in urlList ) {
    println item

        echo "loop ends-----------------------66"
     urlConfigList.add(urlConfig.assign("1","2", "3"))
     echo  "urlConfigList2.size"+urlConfigList.size()
      urlConfigList.add(urlConfig.assign("4","5", "6"))
      echo  "urlConfigList3.size"+urlConfigList.size()
  }
  echo  "urlConfigList4.size"+urlConfigList.size()
    urlConfigList.eachWithIndex { item, index ->
    println item
    println index
    }
    urlConfigList.collectEntries {
        url -> it
        echo it.repo
    }
    
    
    
    
    
    def mvnHome
    stage ('Clone') {
        git url: 'https://github.com/sadheeshkt/spring-cld.git'
    }
    stage('Build') {
         def workspace = pwd()
         def workspacePath= workspace.replace("Program Files (x86)", "PROGRA~2");
         echo 'workspacePath>'+workspacePath
         def pomFile=workspacePath+"/greeting-service/pom.xml"
         
         git url : "https://github.com/sadheeshkt/spring-cld.git"
         mvnHome = tool 'maven3'
         def pom = readMavenPom file: 'greeting-service/pom.xml'
         echo pom.version
         bat "${mvnHome}/bin/mvn -f $pomFile clean compile package"
     }
}
